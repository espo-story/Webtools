<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CPM Login Request</title>
    <style>
        body {
            font-family: 'Courier New', Courier, monospace;
            background-color: #1e1e1e;
            color: #d4d4d4;
            padding: 20px;
            display: flex;
            justify-content: center;
        }
        .container {
            width: 100%;
            max-width: 600px;
            background-color: #252526;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 4px 10px rgba(0,0,0,0.5);
        }
        h2 { color: #569cd6; text-align: center; }
        .form-group { margin-bottom: 15px; }
        label { display: block; margin-bottom: 5px; color: #9cdcfe; }
        input {
            width: 100%;
            padding: 10px;
            background-color: #3c3c3c;
            border: 1px solid #555;
            color: white;
            border-radius: 4px;
            box-sizing: border-box; /* Agar padding tidak melebar */
        }
        button {
            width: 100%;
            padding: 10px;
            background-color: #4ec9b0;
            color: #1e1e1e;
            border: none;
            border-radius: 4px;
            font-weight: bold;
            cursor: pointer;
            margin-top: 10px;
        }
        button:hover { background-color: #3ac9a8; }
        #responseArea {
            margin-top: 20px;
            background-color: #101010;
            padding: 15px;
            border-radius: 5px;
            border: 1px solid #333;
            white-space: pre-wrap; /* Agar JSON rapi */
            word-wrap: break-word;
            font-size: 0.9em;
            color: #ce9178;
        }
        .note { font-size: 0.8em; color: #888; margin-top: 5px; }
    </style>
</head>
<body>

<div class="container">
    <h2>CPM Login Tester</h2>
    
    <div class="form-group">
        <label>URL Endpoint:</label>
        <input type="text" id="url" value="http://192.95.37.8:2340/cpm/login" readonly>
    </div>

    <div class="form-group">
        <label>Email:</label>
        <input type="text" id="email" value="espo@king.lua">
    </div>

    <div class="form-group">
        <label>Password:</label>
        <input type="text" id="password" value="111111">
    </div>

    <button onclick="sendRequest()">Kirim Request</button>

    <div id="responseArea">Menunggu request...</div>
    <div class="note">*Catatan: Pastikan server target mengizinkan CORS (Cross-Origin Resource Sharing).</div>
</div>

<script>
    async function sendRequest() {
        const url = document.getElementById('url').value;
        const email = document.getElementById('email').value;
        const password = document.getElementById('password').value;
        const responseArea = document.getElementById('responseArea');

        // Payload data sesuai Python
        const payload = {
            "email": email,
            "password": password
        };

        // Header configuration
        // Catatan: Browser otomatis mengatur Host dan User-Agent.
        // Kita tidak bisa memaksa mengubah User-Agent di browser standar karena alasan keamanan.
        const headers = {
            "Accept": "application/json",
            "Content-Type": "application/json",
            "X-API-KEY": "cpm_f34afe7563760d904f17ac935dd7771f",
            "Accept-Language": "id-ID,id;q=0.9,en-US;q=0.8,en;q=0.7"
        };

        responseArea.innerHTML = "Mengirim data...";
        responseArea.style.color = "#dcdcaa";

        try {
            const response = await fetch(url, {
                method: 'POST',
                headers: headers,
                body: JSON.stringify(payload)
            });

            const result = await response.text();
            
            // Coba format JSON jika memungkinkan agar rapi
            try {
                const jsonResult = JSON.parse(result);
                responseArea.innerHTML = JSON.stringify(jsonResult, null, 2);
            } catch (e) {
                responseArea.innerHTML = result;
            }

            responseArea.style.color = response.ok ? "#b5cea8" : "#f44747";

        } catch (error) {
            console.error('Error:', error);
            responseArea.style.color = "#f44747";
            responseArea.innerHTML = "Gagal melakukan request.\n\n" + 
                "Kemungkinan penyebab:\n" +
                "1. Server (192.95.37.8) tidak mengizinkan CORS.\n" +
                "2. Server sedang offline.\n" +
                "3. Browser memblokir request HTTP (Mixed Content) jika Anda menjalankannya di HTTPS.";
        }
    }
</script>

</body>
</html>
